(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{8871:function(e,t,s){Promise.resolve().then(s.bind(s,7736))},9782:function(e,t,s){"use strict";s.d(t,{Fs:function(){return n},tO:function(){return o}});var a=s(994),l=s(2307),r=s(9584);let i=(0,a.ZF)({apiKey:"AIzaSyBXlb5oSgzDm-ywBdu6E1OFBrNCIGEsPJc",authDomain:"taylor-made-referral-app.firebaseapp.com",databaseURL:"https://taylor-made-referral-app-default-rtdb.firebaseio.com",projectId:"taylor-made-referral-app",storageBucket:"taylor-made-referral-app.appspot.com",messagingSenderId:"704463799241",appId:"1:704463799241:web:c60d98964a1045c4555e18",measurementId:"G-H8NYFZH8WW"}),n=(0,l.N8)(i),o=(0,r.cF)(i,"gs://taylor-made-referral-app.appspot.com")},7736:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var a=s(7437),l=s(2265),r=s(9782),i=s(2307),n=s(338);function o(e){let{params:t}=e,[s,o]=(0,l.useState)({}),[m,c]=(0,l.useState)([]),[d,f]=(0,l.useState)(0),[u,x]=(0,l.useState)(0),[h,N]=(0,l.useState)([]),[p,g]=(0,l.useState)(!1),[w,j]=(0,l.useState)(""),[v,b]=(0,l.useState)(""),[P,S]=(0,l.useState)(""),[E,y]=(0,l.useState)({email:"",userName:"",firstName:"",lastName:"",earnedPoints:0,redeemedPoints:0,referredUsers:[]});return(0,l.useEffect)(()=>{if(""!==v&&null!=v){g(!0);let e=(0,i.iH)(r.Fs,"Referencers"),t=(0,i.IO)(e,(0,i.g2)("email"),(0,i.EW)(v),(0,i.Kk)(1)),s=(0,i.iH)(r.Fs,"Referrals"),a=(0,i.IO)(s,(0,i.g2)("referrerEmail"),(0,i.EW)(v)),l=(0,i.iH)(r.Fs,"TmUsers"),n=(0,i.IO)(l,(0,i.g2)("email"),(0,i.EW)(v),(0,i.Kk)(1));Promise.all([(0,i.U2)(t),(0,i.U2)(a),(0,i.U2)(n)]).then(e=>{let[t,s,a]=e,l={email:"",userName:"",firstName:"",lastName:"",earnedPoints:0,redeemedPoints:0,referredUsers:[]};if(t.exists()){let e=t.val(),s=Object.keys(e);l.earnedPoints=e[s.toString()].earnedPoints,l.redeemedPoints=e[s.toString()].redeemedPoints}else console.log("No data available");if(s.exists()){let e=s.val(),t=[];for(let s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]={email:e[s].referredEmail,status:e[s].status});o(t)}else console.log("No referral data available");if(a.exists()){let e=a.val(),t=Object.keys(e)[0],s=e[t];l.email=s.email,l.userName=s.first_name+" "+s.last_name,l.firstName=s.first_name,l.lastName=s.last_name,y(l)}else console.log("No user data available");g(!1)}).catch(e=>{console.error(e),g(!1)})}},[v]),(0,l.useEffect)(()=>{c(Object.values(s))},[s]),(0,l.useEffect)(()=>{f(d)},[d]),(0,l.useEffect)(()=>{x(u)},[E]),(0,l.useEffect)(()=>{t.id&&(j(t.id),fetch("/api/tm/user/".concat(t.id),{method:"GET"}).then(e=>e.text()).then(e=>{let t=JSON.parse(e).user;b(t.email);let s=(0,i.iH)(r.Fs,"Referencers"),a=(0,i.IO)(s,(0,i.g2)("email"),(0,i.EW)(t.email));(0,i.U2)(a).then(e=>{if(e.exists()){let s=e.val(),a=Object.keys(s);y({...E,userName:t.first_name+" "+t.last_name,firstName:t.first_name,lastName:t.last_name,email:t.email,earnedPoints:s[a.toString()].earnedPoints,redeemedPoints:s[a.toString()].redeemedPoints})}else console.log("No data available")}).catch(e=>{console.error(e)})}).catch(e=>console.log("error",e)))},[t.id]),(0,l.useEffect)(()=>{var e;console.log("myParam",P),S(null!==(e=new URLSearchParams(window.location.search).get("userId"))&&void 0!==e?e:"")}),(0,l.useEffect)(()=>{P&&""!==P&&(j(P),fetch("/api/tm/user/".concat(P),{method:"GET"}).then(e=>e.text()).then(e=>{let t=JSON.parse(e).user;b(t.email);let s=(0,i.iH)(r.Fs,"Referencers"),a=(0,i.IO)(s,(0,i.g2)("email"),(0,i.EW)(t.email));(0,i.U2)(a).then(e=>{if(e.exists()){let s=e.val(),a=Object.keys(s);y({...E,userName:t.first_name+" "+t.last_name,firstName:t.first_name,lastName:t.last_name,email:t.email,earnedPoints:s[a.toString()].earnedPoints,redeemedPoints:s[a.toString()].redeemedPoints})}else console.log("No data available")}).catch(e=>{console.error(e)})}).catch(e=>console.log("error",e)))},[P]),(0,a.jsxs)("div",{className:"flex min-h-screen flex-col items-center pb-36 p-0",children:[(0,a.jsxs)("div",{className:"max-w-2xl w-full px-6 md:px-0",children:[(0,a.jsx)(n.Z,{text:"Referral Dashboard"}),(0,a.jsx)("div",{className:"max-w-2xl w-full items-center justify-between text-sm lg:flex mt-6",children:(0,a.jsxs)("div",{className:"flex w-full",children:[(0,a.jsx)("div",{className:"flex-auto w-70",children:"User Name"}),(0,a.jsxs)("div",{className:"flex-auto w-30 font-bold text-right",children:[E.firstName," ",E.lastName]})]})}),(0,a.jsx)("div",{className:"max-w-2xl w-full items-center justify-between text-sm lg:flex mt-6",children:(0,a.jsxs)("div",{className:"flex w-full",children:[(0,a.jsx)("div",{className:"flex-auto w-70",children:"Total Referral Points Earned"}),(0,a.jsx)("div",{className:"flex-auto w-30 font-bold text-right",children:E.earnedPoints})]})}),(0,a.jsx)("div",{className:"max-w-2xl w-full items-center justify-between text-sm lg:flex mt-6",children:(0,a.jsxs)("div",{className:"flex w-full",children:[(0,a.jsx)("div",{className:"flex-auto w-70",children:"Total Referral Points Redeemed"}),(0,a.jsx)("div",{className:"flex-auto w-30 font-bold text-right",children:E.redeemedPoints})]})})]}),(0,a.jsxs)("div",{className:"relative max-w-2xl w-full pb-16 px-6 md:px-0",children:[(0,a.jsx)(n.Z,{text:"Referred Users"}),(0,a.jsx)("ul",{className:"referrals-list min-w-100 min-h-20 block",children:m.map((e,t)=>(0,a.jsxs)("li",{className:"flex align-items-center text-left w-full mt-6",children:[(0,a.jsx)("div",{className:"flex-auto w-70",children:String(e.email)}),(0,a.jsx)("div",{className:"flex-auto w-30 font-bold text-right",children:String(e.status)})]},t))}),0!==Object.keys(s).length||p?null:(0,a.jsx)("p",{className:"text-center mt-6",children:"No referred users found"})]})]})}},338:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(7437);function l(e){let{text:t=""}=e;return(0,a.jsx)("div",{className:"form-header max-w-2xl w-full items-center justify-between font-mono text-sm lg:flex mt-6 pb-3",children:(0,a.jsx)("h5",{className:"font-semibold text-lg",children:t})})}s(2265)}},function(e){e.O(0,[481,483,971,938,744],function(){return e(e.s=8871)}),_N_E=e.O()}]);